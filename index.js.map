{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/button-service.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst API_KEY = '46451021-7873f1dc2ed25ef257fef9075';\n\nasync function getPhotos({ query, page, perPage }) {\n  const res = await axios.get('', {\n    params: {\n      key: API_KEY,\n      q: query,\n      page: page,\n      per_page: perPage,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n    },\n  });\n  return res.data;\n}\nexport { getPhotos };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery = new SimpleLightbox('.photo-card a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nfunction clearGallery(galleryRef) {\n  galleryRef.innerHTML = '';\n}\n\nfunction createImageCardsMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\" class=\"gallery-item\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes</b>${likes}</p>\n          <p class=\"info-item\"><b>Views</b>${views}</p>\n          <p class=\"info-item\"><b>Comments</b>${comments}</p>\n          <p class=\"info-item\"><b>Downloads</b>${downloads}</p>\n        </div>\n      </div>\n      `\n    )\n    .join('');\n}\n\nfunction renderGallery(galleryRef, markup) {\n  galleryRef.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction refreshLightbox() {\n  gallery.refresh();\n}\n\nexport { clearGallery, createImageCardsMarkup, renderGallery, refreshLightbox };\n","export default class ButtonService {\n  static HIDDEN_CLASS = 'is-hidden';\n\n  constructor(buttonEl) {\n    this.button = buttonEl;\n  }\n\n  disable() {\n    this.button.disabled = true;\n  }\n  enable() {\n    this.button.disabled = false;\n  }\n  hide() {\n    this.button.classList.add(ButtonService.HIDDEN_CLASS);\n  }\n  show() {\n    this.button.classList.remove(ButtonService.HIDDEN_CLASS);\n  }\n  setLoading() {\n    this.disable();\n    this.prevText = this.button.textContent;\n    this.button.textContent = 'Loading images, please wait...';\n  }\n  setNormal() {\n    this.button.textContent = this.prevText;\n    this.enable();\n  }\n}\n","import { getPhotos } from './js/pixabay-api';\nimport {\n  clearGallery,\n  createImageCardsMarkup,\n  renderGallery,\n  refreshLightbox,\n} from './js/render-functions';\nimport ButtonService from './js/button-service';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchForm = document.querySelector('#search-form');\nconst galleryRef = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loader = document.querySelector('.loader');\n\nconst loadMoreBtnService = new ButtonService(loadMoreBtn);\n\nconst params = {\n  page: 1,\n  perPage: 15,\n  maxPage: 1,\n  query: '',\n};\n\nsearchForm.addEventListener('submit', onSearch);\n\nfunction onSearch(event) {\n  event.preventDefault();\n  params.page = 1;\n  const query = event.target.elements.searchQuery.value.trim();\n\n  if (query === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query!',\n      position: 'topRight',\n    });\n    return;\n  }\n  params.query = query;\n\n  clearGallery(galleryRef);\n\n  fetchImages(query);\n}\n\nasync function fetchImages(query) {\n  loader.style.display = 'inline-block';\n  loadMoreBtnService.hide();\n  try {\n    const data = await getPhotos({\n      query: params.query,\n      page: params.page,\n      perPage: params.perPage,\n    });\n    if (data.hits.length === 0) {\n      iziToast.info({\n        title: 'No Results',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    params.maxPage = Math.ceil(data.totalHits / params.perPage);\n\n    const markup = createImageCardsMarkup(data.hits);\n    renderGallery(galleryRef, markup);\n    refreshLightbox();\n\n    if (params.maxPage > params.page) {\n      loadMoreBtnService.show();\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `Something went wrong: ${error.message}`,\n      position: 'topRight',\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\nasync function handleLoadMore(event) {\n  loadMoreBtnService.setLoading();\n  params.page += 1;\n\n  try {\n    const data = await getPhotos({\n      query: params.query,\n      page: params.page,\n      perPage: params.perPage,\n    });\n\n    const markup = createImageCardsMarkup(data.hits);\n    renderGallery(galleryRef, markup);\n    refreshLightbox();\n\n    const { height: cardHeight } =\n      galleryRef.firstElementChild.getBoundingClientRect();\n    const gap = 16;\n\n    window.scrollBy({\n      top: (cardHeight + gap) * 2,\n      behavior: 'smooth',\n    });\n\n    loadMoreBtnService.setNormal();\n\n    if (params.maxPage === params.page) {\n      loadMoreBtnService.hide();\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `Something went wrong: ${error.message}`,\n      position: 'topRight',\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n"],"names":["axios","API_KEY","getPhotos","query","page","perPage","gallery","SimpleLightbox","clearGallery","galleryRef","createImageCardsMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","markup","refreshLightbox","_ButtonService","buttonEl","__publicField","ButtonService","searchForm","loadMoreBtn","loader","loadMoreBtnService","params","onSearch","event","iziToast","fetchImages","data","handleLoadMore","error","cardHeight"],"mappings":"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"}